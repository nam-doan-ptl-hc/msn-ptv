import './polyfills.server.mjs';
import{a as O}from"./chunk-4GEGJ36S.mjs";import{$a as m,Aa as p,B as d,Ba as o,Bd as E,Ca as i,Cd as L,Da as u,Dd as M,Fd as b,Hd as k,Id as N,Jd as T,Kc as S,Ma as C,Na as f,Nc as v,Oc as F,Od as D,Rb as w,Vb as y,W as x,Yb as _,aa as s,ha as h,la as g,lc as I,wd as P,yd as c}from"./chunk-WM6JHRFK.mjs";import"./chunk-N7QBYMCK.mjs";function A(t,r){t&1&&(o(0,"small"),m(1,"Enter an email or mobile number."),i())}function G(t,r){t&1&&(o(0,"small"),m(1,"Account is invalid."),i())}function B(t,r){if(t&1&&(o(0,"div",15),g(1,A,2,0,"small",16)(2,G,2,0,"small",16),i()),t&2){let n,e,l=f();s(),p("ngIf",(n=l.loginForm.get("email"))==null||n.errors==null?null:n.errors.required),s(),p("ngIf",(e=l.loginForm.get("email"))==null||e.errors==null?null:e.errors.email)}}function j(t,r){t&1&&(o(0,"small"),m(1,"Enter a password."),i())}function R(t,r){if(t&1&&(o(0,"div",15),g(1,j,2,0,"small",16),i()),t&2){let n,e=f();s(),p("ngIf",(n=e.loginForm.get("password"))==null||n.errors==null?null:n.errors.required)}}var q=class t{loginForm;api=d(F);router=d(I);snackBar=d(O);platformId=d(x);constructor(){this.loginForm=new M({email:new b("",[c.required,c.email]),password:new b("",[c.required])})}ngOnInit(){if(_(this.platformId)){let r=JSON.parse(localStorage.getItem("user_info")||"{}");r&&r.token&&this.router.navigate(["/dashboard"]),setTimeout(()=>{document.body.classList.add("login-background")})}}ngOnDestroy(){_(this.platformId)&&document.body.classList.remove("login-background")}submitLogin(){if(this.loginForm.invalid){this.loginForm.markAllAsTouched();return}let r=this.loginForm.get("email")?.value||"",n=this.loginForm.get("password")?.value||"",e=new Date().setHours(0,0,0,0),l={token:v.googleToken(e.toString()),req_time:e,account:r,pwd:v.hashPassword(n),device_info:{name:"",device_type:"Linux",os:"Linux",os_version:"",manufacturer:"",model:"",browser:"Chrome",browser_version:"134.0.0.0"},keep_logged_in:!1,domain_name:S.domain};this.api.postFormEncoded("/signin",l).subscribe({next:a=>{if(a.code!=0){this.snackBar.open(a.msg,"x",{duration:3e3,horizontalPosition:"right",verticalPosition:"top",panelClass:["error-snackbar"]});return}localStorage.setItem("user_info",JSON.stringify(a.data)),this.router.navigate(["/dashboard"])},error:a=>{this.snackBar.open("Error login","close",{duration:3e3,panelClass:["error-snackbar"]})}})}static \u0275fac=function(n){return new(n||t)};static \u0275cmp=h({type:t,selectors:[["login"]],decls:23,vars:3,consts:[[1,"container","wrapper-login","justify-content-center","align-items-center"],[1,"login-box","reg-step-1",2,"display","block"],[1,"login-header"],["href","/",1,"login-logo-temp"],["src","/assets/images/logo-patient.svg"],[1,"login-body","box-content-login"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","exampleInputEmail1",1,"form-label"],[1,"sp-star"],["type","email","id","exampleInputEmail1","aria-describedby","emailHelp","formControlName","email",1,"form-control"],["class","text-danger",4,"ngIf"],["for","exampleInputPassword1",1,"form-label"],["type","password","id","exampleInputPassword1","formControlName","password",1,"form-control"],["type","submit",1,"btn","btn-primary","btn-login"],[1,"text-danger"],[4,"ngIf"]],template:function(n,e){if(n&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"a",3),u(4,"img",4),i()(),o(5,"div",5)(6,"form",6),C("ngSubmit",function(){return e.submitLogin()}),o(7,"div",7)(8,"label",8),m(9,"Email or Mobile Number "),o(10,"span",9),m(11,"*"),i()(),u(12,"input",10),g(13,B,3,2,"div",11),i(),o(14,"div",7)(15,"label",12),m(16,"Password "),o(17,"span",9),m(18,"*"),i()(),u(19,"input",13),g(20,R,2,1,"div",11),i(),o(21,"button",14),m(22,"Login"),i()()()()()),n&2){let l,a;s(6),p("formGroup",e.loginForm),s(7),p("ngIf",((l=e.loginForm.get("email"))==null?null:l.touched)&&((l=e.loginForm.get("email"))==null?null:l.invalid)),s(7),p("ngIf",((a=e.loginForm.get("password"))==null?null:a.touched)&&((a=e.loginForm.get("password"))==null?null:a.invalid))}},dependencies:[D,k,P,E,L,N,T,y,w],styles:["h2[_ngcontent-%COMP%]{color:red}.login-box[_ngcontent-%COMP%]{overflow:inherit;padding:20px 0;width:500px;vertical-align:middle;text-align:center;margin:auto}.login-logo-temp[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:40px;margin-bottom:20px}.login-body[_ngcontent-%COMP%]{border:0px solid;box-shadow:0 0 19px #0000004d;border-radius:0;background:#fff;height:auto;margin:1%;position:relative;padding:20px}.form-label[_ngcontent-%COMP%]{float:left}.text-danger[_ngcontent-%COMP%]{text-align:left}.wrapper-login[_ngcontent-%COMP%]{display:flex;height:100%}.btn-login[_ngcontent-%COMP%]{min-width:140px}.sp-star[_ngcontent-%COMP%]{color:red;font-size:12px}"]})};export{q as LoginComponent};
